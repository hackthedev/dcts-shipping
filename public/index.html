<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
          name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <meta content="" name="expires"/>

    <!-- <meta name="description" content="{{meta.page.description}}" /> -->

    <script src="js/core/socket.io.js"></script>
    <script src="js/core/sortable.js"></script>

    <!-- New to-be-implement features-->
    <script src="js/alerts.js?v={{random}}"></script>
    <script defer src="js/prompts.js?v={{random}}"></script>
    <script src="js/tooltips.js?v={{random}}"></script>
    <script src="js/sysmsg.js?v={{random}}"></script>
    <script src="js/upload.js?v={{random}}"></script>

    <script src="audioplayer/audioplayer.js?v={{random}}"></script>


    <link href="/settings/account/page/profile/profile.css?v={{random}}" rel="stylesheet">

    <link href="css/messages.css?v={{random}}" rel="stylesheet">
    <link href="highlight.css?v={{random}}" rel="stylesheet">
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">

    <link href="css/themes/default/default.css?v={{random}}" rel="stylesheet">
    <link href="css/emojis.css?v={{random}}" rel="stylesheet">
    <link href="css/message_actions.css?v={{random}}" rel="stylesheet">
    <link href="css/contextmenu.css?v={{random}}" rel="stylesheet">
    <link href="style.css?v={{random}}" rel="stylesheet">
    <link href="css/network-servers.css?v={{random}}" rel="stylesheet">
    <link href="css/channeltree.css?v={{random}}" rel="stylesheet">
    <link href="css/mobile/main.css?v={{random}}" rel="stylesheet">
    <link href="css/screenshare.css?v={{random}}" rel="stylesheet">
    <link href="audioplayer/audioplayer.css?v={{random}}" rel="stylesheet">
    <link href="css/groups/groupHomeDisplay.css?v={{random}}" rel="stylesheet">
    <link href="css/emoji-autocomplete.css?v={{random}}" rel="stylesheet">


    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <script defer src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/default.min.css" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/ruby.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/css.min.js"></script>

    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <!-- tooltips -->
    <script src="js/tooltips/dialogs/createChannel.js?v={{random}}"></script>
    <script src="js/tooltips/dialogs/banUser.js?v={{random}}"></script>
    <script src="js/tooltips/dialogs/muteUser.js?v={{random}}"></script>
    <script src="js/tooltips/dialogs/newUserExplainUI.js?v={{random}}"></script>
    <script src="js/tooltips/dialogs/accountOnboarding.js?v={{random}}"></script>

    <!-- general chat functions -->
    <script src="js/discovery.js?v={{random}}"></script>
    <script src="js/escape.js?v={{random}}"></script>
    <script src="js/hover.js?v={{random}}"></script>
    <script src="js/vc-handler.js?v={{random}}"></script>

    <script src="js/core/livekit.js?v={{random}}"></script>
    <script src="js/core/FileManager.js?v={{random}}"></script>
    <script src="js/core/ModView.js?v={{random}}"></script>
    <script src="js/core/UserReports.js?v={{random}}"></script>
    <script src="js/core/ContextMenu.js?v={{random}}"></script>
    <script src="js/markdown.js?v={{random}}"></script>
    <script src="js/emojis.js?v={{random}}"></script>
    <script src="js/core/Badges.js?v={{random}}"></script>
    <script src="js/core/CookieManager.js?v={{random}}"></script>
    <script src="js/core/ModActions.js?v={{random}}"></script>
    <script src="js/core/AdminActions.js?v={{random}}"></script>
    <script src="js/core/ChatManager.js?v={{random}}"></script>
    <script src="js/core/UserManager.js?v={{random}}"></script>
    <script src="js/core/Channeltree.js?v={{random}}"></script>
    <script src="js/core/Home.js?v={{random}}"></script>
    <script src="js/core/Crypto.js?v={{random}}"></script>
    <script src="js/core/Client.js?v={{random}}"></script>

    <script src="js/effects/confetti.js?v={{random}}"></script>
    <script src="js/effects/party.js?v={{version}}"></script>
    <script src="js/effects/pixel.js?v={{random}}"></script>
    <script src="js/effects/glitch.js?v={{random}}"></script>
    <script src="js/effects/splashscreen.js?v={{random}}"></script>

    <script src="/plugins/loader.js?v={{random}}"></script>


    <script src="js/core/PoW.js?v={{random}}"></script>
    <script src="js/core/voip.js?v={{random}}"></script>


    <script defer src="chat.js?v={{random}}"></script>
    <script defer src="js/messages/server/messages.js?v={{random}}"></script>
    <script defer src="js/channels/channels.js?v={{random}}"></script>
    <script defer src="js/groups/groups.js?v={{random}}"></script>

    <meta content="{{meta.page.description}}" name="description">
    <title>{{meta.page.title}}</title> <!-- {{meta.page.title}} -->
</head>
<body>

<div id="mainLayout">
    <div id="header">

        <!--
            This is defined here but pretty much replaced once domloaded fires.
            Why bother putting it here you may ask? To stop the header from collapsing
            and then going back to its proper size again, as i dont wanna hardcode a min. height
            for it to potentially change if elements or font sizes change and have problem all over
            again.

            The empty divs are here to keep the grid layout from breaking.
        -->
        <div></div>
        <div></div>

        <div id="headerRight">
            <div class="headerIcon help"></div>
        </div>
    </div>

    <div id="contentLayout">

        <div class="mobilePanel">
            <div id="leftSideMenu">
                <div id="mobile_GroupAndChannelContainer">
                    <div id="mobile_GroupListContainer">
                        <div id="mobile_GroupList"></div>
                    </div>

                    <div id="mobile_ChannellistContainer">
                        <div id="mobile_groupBanner"><img id="mobile_groupBannerDisplay"/></div>
                        <div id="mobile_channelList"></div>

                        <div id="profile_settings">
                            <a href="/settings/account">Account Settings</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="networkServers">

            <div id="networkActivatorUi">
                <div class="networkIndicator">1</div>
                <span class="networkIndicatorIcon">&#127760;</span>
            </div>

            <div id="networkServerList">
                <div class="networkServerEntry">
                    <img src="/uploads/upload_167339467293_astolfo_shrug.png">
                    <div class="networkIndicator">1</div>
                </div>

                <div class="networkServerEntry">
                    <img src="/uploads/upload_167339467293_astolfo_shrug.png">
                    <div class="networkIndicator">99</div>
                </div>
            </div>
        </div>


        <div id="serverlist"></div>
        <div id="channellist">

            <div id="serverbanner-container">
                <img id="serverbanner-image" src="/img/loading.gif">
            </div>

            <div id="channeltree"></div>

            <div id="profile-qa">

                <div class="row voip invisible">
                    <span id="vcStatusText"></span> <span id="vcStatusChannelname"></span>

                    <div class="profile-qa-actions right">
                        <a onclick="leaveVC()">
                            <div class="profile-qa-icon voip"></div>
                        </a>
                    </div>
                </div>

                <div class="row">
                    <div id="profile-qa-img-container">
                        <img id="profile-qa-img" onerror="this.src = '/img/default_pfp.png';">
                    </div>

                    <div id="profile-qa-info">
                        <Label id="profile-qa-info-username" title="Edit your username">-</Label><br>
                        <Label id="profile-qa-info-status" title="Edit your status">-</Label>
                    </div>

                    <div class="profile-qa-actions right">
                        <a href="/settings/account">
                            <div class="profile-qa-icon settings"></div>
                        </a>
                    </div>
                </div>

            </div>
        </div>


        <div id="content-container">

            <div id="channelname-bar">
                <div id="channelname"></div>
                <div id="channelname-icons"></div>
            </div>

            <div id="content"></div>

            <div id="message-actions">
                <div id="emoji-box-container" style="display: none;">

                    <div id="emoji-box-header-container">
                        <div class='emoji-box-header' id="emoji-box-emojis"
                             onclick="getEmojis(); selectEmojiTab(this);">
                            <h2>Emojis</h2>
                        </div>
                        <div class='emoji-box-header' id="emoji-box-gifs" onclick="getGifs(); selectEmojiTab(this);">
                            <h2>GIFs</h2>
                        </div>
                    </div>

                    <div id="emoji-entry-container"></div>
                    <div id="gif-entry-container"></div>
                </div>
            </div>

            <div id="messagebox">
                <div>
                    <div id="messagebox-media"></div>
                    <div class="editor-container" style="z-index: 200 !important;">
                        <div id="editor-toolbar" style="border: none !important;">
                            <!-- Add toolbar buttons as needed -->
                            <span class="ql-formats" style="border-right: 2px solid lightgray !important;">
                                <button class="ql-bold" title="Bold"></button>
                                <button class="ql-italic" title="Italic"></button>
                                <button class="ql-underline" title="Underline"></button>
                                <button class="ql-strike" title="Strikeout"></button>
                                <button class="ql-clean" title="Remove formatting"></button>
                         </span>

                            <span class="ql-formats" style="border-right: 2px solid lightgray !important;">
                        <button class="ql-link" title="Link"></button>
                                <!--<button title="Image" class="ql-image"></button>
                                <button title="Video" class="ql-video"></button>-->
                    </span>

                            <span class="ql-formats" style="border-right: 2px solid lightgray !important;">
                        <button class="ql-code" title="Inline Code"></button>
                        <button class="ql-code-block" title="Code Block"></button>
                        <button class="ql-blockquote" title="Blockquote"></button>
                    </span>

                            <span class="ql-formats" style="border-right: 2px solid lightgray !important;">
                        <button class="ql-list" title="Numbered List" value="ordered"></button>
                        <button class="ql-list" title="Bullet List" value="bullet"></button>
                        <button class="ql-formula" title="Formula"></button>
                    </span>

                            <img id="message-actions-image" src="/img/emoji.png">
                        </div>
                        <div id="editor" style="border: none !important;"></div>
                    </div>
                </div>


                <div id="typing-indicator-container"><label id="typing-indicator">H</label></div>
            </div>

        </div>
        <div id="infolist"></div>


        <div class="mobilePanel">
            <div id="rightSideMenu">
                    <div id="mobile_memberlist"></div>
            </div>
        </div>
    </div>
</div>


<div id="modalBox">
    <h1 id="modalBoxTitle">-</h1>
    <p id="modalBoxText">-</p>
    <div id="modalBoxButtons"></div>
</div>

<div id="popup-container">
    <div id="popup-content">

    </div>
</div>


<div id="context-menu"></div>


<!-- Markdown Editor -->
<style>
    .editor-container {
        width: calc(100% - 40px) !important;
        border-radius: 8px;
        /*box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);*/
        padding: 0px;


        margin-left: -8px !important;
        border-radius: 8px;

        display: block;
        float: left;

        transition: height 0.3s ease, transform 0.3s ease, margin 0.3s ease;
        margin-left: 0px;
    }

    .ql-toolbar {
        border: none;
    }

    .ql-container {
        color: #ffffff;
        border: none;
        transition: height 0.3s ease;
        display: flex;
        flex-direction: column;
    }

    .ql-editor {
        color: #ffffff;
        overflow-y: auto;
        /* Make it scrollable */
        flex: 1;
        /* Ensure it grows to fill the container */
        max-height: 400px;
        /* Limit max height */
        padding-bottom: 8px;
        overflow-y: auto;
        /* Make it scrollable */
    }

    .ql-toolbar button {
        color: #ffffff !important;
    }

    .ql-toolbar button:hover {
        color: #7289da !important;
    }

    .ql-toolbar .ql-stroke {
        fill: none;
        stroke: lightgray;
    }

    .ql-toolbar .ql-picker {
        color: white;
    }

    .ql-toolbar .ql-even {
        color: lightgray;
    }

    .ql-toolbar .ql-blockquote {
        color: lightgray;
    }

    .ql-toolbar .ql-video {
        stroke: lightgray;
        fill: none;
    }

    .ql-toolbar .ql-image {
        color: lightgray;
        stroke: lightgray;
        fill: none;
    }

    .ql-toolbar .ql-strike {
        stroke: lightgray;
        fill: none;
    }

    .ql-toolbar .ql-list {
        stroke: lightgray;
        fill: none;
    }

    .ql-toolbar .ql-formula {
        stroke: lightgray;
        fill: none;
    }

    .ql-toolbar button:hover {
        color: red !important;
    }
</style>


<div id="profile-role-menu">

    <div id="role-menu-header">
        <input id="role-menu-search-input" oninput="searchForRoleInList(this.value)" placeholder="Search Role"
               type="text">
        <div id="role-menu-search-icon"></div>
    </div>
    <div id="role-menu-list"></div>
</div>

<script>

    document.addEventListener("DOMContentLoaded", function () {
        ContextMenu.init();
    })

    function searchForRoleInList(search) {
        var roles = document.getElementById("role-menu-list").querySelectorAll(".role-menu-entry")


        roles.forEach(role => {
            var roleName = role.querySelector("label").innerText.toLowerCase();

            if (roleName.includes(search.toLowerCase())) {
                console.log("Found " + roleName)
                role.style.display = "block";
            } else {
                console.log("Didnt find " + roleName)
                role.style.display = "none"
            }
        })
    }
</script>


<!-- Mobile HTML-->




<div id="profile_container" style="display: none;position: fixed;z-index: 10000;">
    <div id="profile_banner"></div>

    <div id="profile_pfp_container">
        <div id="profile_pfp"></div>
    </div>

    <div id="profile_content">
        <div id="profile_username">
            <h2></h2>
        </div>
        <div id="profile_status"></div>
        <hr>

        <h2 class="profile_headline"></h2>
        <div id="profile_aboutme">
        </div>
        <hr>

        <h2 id="profile_headline"></h2>
        <div id="profile_roles">
            <code class="role">
                <div class="role_color"></div>
                +</code>
        </div>
    </div>
</div>


<div id="homeScreen"></div>
</body>
</html>